---
layout: post
title: Introduction To IDPS: Intrusion Detection and Prevention Systems
---

  The internet of today is filled with bad actors trying to steal money, steal information, and damage companies’ reputations by attempting to gain unauthorized access into their networks. A great way to stop these bad actors is to deploy an intrusion detection and prevention system (IDPS). An IDPS is an umbrella of hardware devices that, when placed on a network, detect, prevent, and aid in response to unauthorized intrusions. It “adds another level of defense to firewalls, virtual private networks (VPNs), and other security devices” (Weaver, Weaver, & Farwood, 2014). Keep in mind that an IDPS is not meant to replace a firewall, they are meant to increase security in the internal network. Why do we need this increased security? Firewalls are designed to manage security at the front door, but if an unauthorized user gets past the firewall then you are out of luck. An IDPS solves this problem because it monitors the internal network for suspicious activity.

  There are different techniques that an IDPS deploys to monitor the internal network. There are anomaly based IDPSs and there are signature based IDPSs. Anomaly based systems are designed to constantly check network traffic against a predefined baseline. The predefined baseline is required for these devices to be effective and can take anywhere from a week to two weeks to calibrate. Anomaly-based systems are fantastic for catching odd events on the network and catching new (zero day) attack methods. A downside to anomaly based IDPSs is that they are only as good as the baseline network measurement. If the baseline is measured when there is abnormal network behavior, then that baseline would be useless for normal network traffic behavior. An example would be if a baseline were being taken when the company is going through a network update. Clearly the baseline considers this odd network activity as normal which is not what you want. Also, the baseline would have to be updated consistently when any network changes occur like when adding or removing employees. Another option for an IDPS detection technique is called signature based detection. With signature based detection, the IDPS monitors network attacks based on specific attack techniques called signatures that display characteristics of an attack occurring. These systems are fantastic for instant installation because they do not require a baseline measurement. They are also “easy to understand and less difficult to configure than an anomaly-based system” (Weaver, Weaver, & Farwood, 2014). Some disadvantages of these systems are that they constantly need to be updated with new signatures and that if an attack makes minor changes to their attack, they probably will not trigger a signature alarm. 

  Some positions you can place these sensors include inline or passive. An inline sensor would be placed directly in the network, most likely on a wire that carries most if not all of the network traffic. Inline sensors are placed in a position where network traffic must pass through them and they investigate each packet of information that pass through it. An advantage of inline sensors is that they are able to stop an attack dead in its tracks if it catches one (Weaver, Weaver, & Farwood, 2014). One disadvantage of an inline sensor is that it could cause a bottleneck in the network and it could be a point of latency. Because an inline sensor is actively looking at packets, it must first stop the packet, open the packet, determine if this packet is acceptable, send a copy of the packet to the management server, and then finally send the packet to its destination. 

(Inline Sensor Positioning)

  As for a passive sensor, these are placed in key locations in the network “such as divisions between networks, or on key network segments” (Weaver, Weaver, & Farwood, 2014). These IDPS sensors only monitor copies of the actual traffic and are unable to stop an attack that is occurring. A benefit to this is that they do not cause latency or a bottleneck in the network because they don’t actually stop traffic. 

(Passive sensor Positioning)

  When an anomaly occurs or a signature is triggered, the IDPS needs a place to send that error and all the relevant data of the attack. There are two options for handling this and those are central and distributed management deployment. Central deployment would require an IDPS management server that is a “central repository for sensor and agent data” (Weaver, Weaver, & Farwood, 2014). These servers collect, analyze, and store data from multiple sensors making it easy for an IT administrator to monitor the situation. Some very large companies even have several of these servers. The benefit of a central deployment is the convenience of having the whole network layout and activity at your fingertips. One drawback is that if that central management server goes down, then your mitigation efforts are dead in the water. Another way to handle sensor data is to have it distributed among each sensor and agent. This design is better for smaller companies that maybe can’t afford a management server. In this design the sensors send information directly to a certain host normally the admins. A centralized management server is highly recommended over a distributed deployment.

  IDPS sensors should be located in strategic areas of the network like common entry points on the network. These spots include, just behind a firewall, in a DMZ, or on any LAN segment of the network. Just behind the firewall is a key spot because all the traffic in the network flows through that one spot. This makes it optimal for monitoring your network traffic in and out of the network. The DMZ is another spot an IDPS should be placed. The DMZ is a less trusted spot on the network which holds your web server, DNS server, and/or email server where people from outside the network are looking to connect to. An IDPS on a DMZ would see a lot of different traffic so a signature-based sensor on the DMZ would work well. Then you would also want sensors on your local area network (LAN). An anomaly-based sensor here would be better because the work done on the LAN would be very similar week to week. These sensors would monitor LAN network traffic and protect employee accounts from bad actors and detect and stop new attacks. Keep in mind that with wireless networks there would have to be sensors placed at strategic spots on that network as well. These sensors are wireless sensors and they “should be deployed so that they monitor the RF range of the organization’s WLANs (both APs and STAs), which often includes mobile components such as laptops and PDAs” (Scarfone & Mell, 2007). 

(IDPS Positioning Picture)

  Configuring the IDPS is just as important as selecting the right one. An IDPS is only as strong as the settings and rules it has in place. Some best practices for IDPS include but are not limited to encrypting communications and testing IDPS signatures and baseline so that they are kept up to date. When selecting an IDPS it is important to think about how much throughput the IDPS needs on our network. “The IPS has to be able to handle the load you throw at it with an acceptable level of latency” (Snyder, 2020). We do not want the IDPS to slow down the network by any means. Also the IDPS “should be able to continue operating during denial of service attacks” (Weaver, Weaver, & Farwood, 2014). Tuning the IDPS for your network is a big determination on how successful the IDPS is going to be at detecting true positive attacks. IDPS systems have to be tuned properly or else it will report many false positives which waste time or it misses true positives which would be much worse. Tuning the IDPS by updating the baseline or tweaking signatures allows you to reduce the number of false positives from you IDPS system. 
  The general architecture of the network should include Intrusion Detection and Prevention System sensors among key points in the network. The use of a hybrid system that incorporates signature-based and anomaly-based detection is also advised. Specifically, signature-based sensors in a DMZ and anomaly-based sensors in the LAN is recommended. Keep in mind that these systems are not plug and play, they require constant tuning, monitoring, and updating to keep them accurate and useful. “The average cost of a data breach in 2020 is $3.86 million” (Swinhoe, 2020) and having an IDPS in place is very useful in mitigating a breach so it is highly recommended to implement one.

References

Scarfone, K., & Mell, P. (2007, Feb). Guide to Intrusion Detection and Prevention Systems (IDPS). Retrieved from National Institute of Standards and Technology: https://citadel-     information.com/wp-content/uploads/2012/08/nist-sp800-94-guide-to-intrusion-detection-and-prevention-systems-2007.pdf

Snyder, J. (2020). Best Practices for Deploying Network Intrusion Prevention. Retrieved from PCWorld:             https://www.pcworld.com/article/144634/guide_network_intrusion_prevention_systems.html#:~:text=1.)&text=Your%20IPS%20will%20generally%20be,performance%20issues%20under%20tight%2  0control.

Swinhoe, D. (2020, Aug 13). What is the cost of a data breach? Retrieved from CSO: https://www.csoonline.com/article/3434601/what-is-the-cost-of-a-data-breach.html#:~:text=The%20average%20cost%20of%20a,over%20the%20last%20five%20years.

Weaver, R., Weaver, D., & Farwood, D. (2014). Guide to Network Defense and Countermeasures. Boston: Course Technology, Cengage Learning.



